from base64 import b64decode
from hashlib import sha512

from asn1crypto import x509

from infiniteidpq_device_manager.oqspython import oqspython

# Set the serial port name and baud rate
oqs = oqspython.OQS_SIGNATURE(oqspython.OQS_SIG_alg_dilithium_5)

signature = "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"  # noqa: E501

certificate = "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"  # noqa: E501


# Prepare message
origin = "https://ria.ee"
challengeNonce = "12345678901234567890123456789012345678901234"
originHash = sha512(origin.encode()).digest()
challengeNonceHash = sha512(challengeNonce.encode()).digest()
hashToBeSigned = sha512(originHash + challengeNonceHash).digest()

# Prepare public key
x509_cert = x509.Certificate.load(b64decode(certificate))

# Generate keypair
result = oqs.verify(
    hashToBeSigned,
    len(hashToBeSigned),
    b64decode(signature),
    oqs.length_signature,
    x509_cert.native["tbs_certificate"]["subject_public_key_info"][
        "public_key"
    ],
)
if result != oqspython.OQS_SUCCESS:
    print("Error verifying signature")
    exit()

print("Finished successfully")
